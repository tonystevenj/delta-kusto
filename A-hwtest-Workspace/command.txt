
# Dev:

dotnet build code/delta-kusto-solution.sln --no-restore


# CD to consumer folder so that parameters in the job yaml config can use relative path
cd C:\Users\Hongjing-Data\VSCode-Workspace\PowerApps-Telemetry

# build:
dotnet build code/delta-kusto-solution.sln --no-restore


# pull playground:
powershell -Command ('

C:/Users/Hongjing-Data/VSCode-Workspace/delta-kusto/code/delta-kusto/bin/Debug/net7.0/delta-kusto.exe
-p C:\Users\Hongjing-Data\VSCode-Workspace\PowerApps-Telemetry\A-hwtest-workspace\Kusto-Delta\deployment\sync-prod-test-builtIn.yaml

' -replace("`n", " "))

# pull:
powershell -Command ('

C:/Users/Hongjing-Data/VSCode-Workspace/delta-kusto/code/delta-kusto/bin/Debug/net7.0/delta-kusto.exe
-p C:\Users\Hongjing-Data\VSCode-Workspace\PowerApps-Telemetry\A-hwtest-workspace\Kusto-Delta\deployment\sync-prod.yaml

' -replace("`n", " "))

# Calculate Delta
powershell -Command ('

C:/Users/Hongjing-Data/VSCode-Workspace/delta-kusto/code/delta-kusto/bin/Debug/net7.0/delta-kusto.exe
-p C:/Users/Hongjing-Data/VSCode-Workspace/PowerApps-Telemetry/A-hwtest-workspace/Kusto-Delta/deployment/generate-kusto-delta.yaml

' -replace("`n", " "))


# Release:

dotnet pack code/delta-kusto/delta-kusto.csproj -c Release

dotnet nuget push --source "https://msazure.pkgs.visualstudio.com/_packaging/hwtest-feeds-msazure/nuget/v3/index.json" `
--api-key az C:/Users/Hongjing-Data/VSCode-Workspace/delta-kusto/code/delta-kusto/nupkg/delta-kusto.0.15.7.nupkg

